# 心得总结

## Python

### 关于依赖管理

* 使用requirements.txt管理依赖是好的实践，在此之外，除非第三方依赖的升级一定不会对你的应用有影响，锁定依赖的版本是非常有必要的。避免因为第三方依赖的升级，导致工程出现异常的状况。这种问题往往难以排查。
* 使用virtualenv来做python环境隔离在实践中受益匪浅，但是关于依赖更新，一直没有特别好的方法，包括--force-install等等。 我们采用的方案是在任务结束的clean up阶段，把虚拟环境创建的目录整个删除掉，任务开始时创建虚拟环境。 虽然会带来一定的额外的时间和网络的开销，但比起CI过程稳定，避免依赖更新带来的诡异问题，这点代价可以接受。

### 依赖缓存

* 在CI/CD对接过程中，下载安装Python依赖成为一个薄弱点，导致流程失败，和对外网带宽造成压力。搭建内网缓存是非常好的实践。SonaType Nexus表现良好。同理，其他语言的依赖，docker镜像管理，都可以沿用这个思路。 docker镜像仓库可以使用harbor。

### 高可用

* 凡是涉及到网络请求通信的地方，都必须要有重试机制。

### Best Practice

* jenkins文件中只负责CI脚本的检出，代码检出的逻辑在jenkinsfile中，由项目组自己处理。
* 了解用户的原始需求, 不要着急动手一头扎进问题中。
  * 为什么要这样做？
  * 谁要求做这件事情的？
  * 这样做的目的是什么？
  * 这样做是为了解决什么问题？
