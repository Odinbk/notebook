# TKW 项目周报 - 2021-01-16

## 重要时间节点

- 暂无更新

## 本周总结

* TKW TSS流程测试验收：基础的服务启停，版本发布功能已经测试没有问题。 目前GameServer等服务不能正常工作，原因在调查定位中。
  * 基本定位到是由于腾讯提供的MongoDB为Standalone模式，而不是我们期望的ReplicaSet模式。
* ResourceCenter 保存客户端更新包的目录调整：移除包上层的版本目录，所有的更新包都放到一个bucket下。 修改为了支持测试在内网环境下可以从ResourceCenter直接下载，优化测试体验。 改动现在TKW上线，后续迁移到GRAN。
* 审核版本/体验版本发布流程优化，版本发布时，直接从压缩包中提取审核/体验版本中的配置信息，写入ZooKeeper。 避免解压缩覆盖正式服服务器上的文件。

## 下周工作

* 确定腾讯IDC中服务工作不正常的问题，要求腾讯DBA提供ReplicaSet模式的MongoDB实例。
* TKW Tools脚本迁移到Pillar重写的版本，对应的服务端适配代码合并主干。
* TKW在ResourceCenter上的数据迁移到访问速度更快的Ceph集群中。

## 工具接入

### 已完成的系统对接

| 系统名称      | 优先级 | 状态 | ETA  | 说明                   |
| ------------- | ------ | ---- | ---- | ---------------------- |
| 天梯          | `高`   | 完成 |      | 灰度，审核相关暂未展开 |
| 前后端报错    | `高`   | 完成 |      | 已接入，持续迭代       |
| BI            | `高`   | 完成 |      | 已接入，持续迭代       |
| GM            | `高`   | 完成 |      | 已接入，持续迭代       |
| 鹰眼          | `高`   | 完成 |      | 已接入，持续迭代       |
| 监控/报警系统 | `高`   | 完成 |      |                        |

## 集群资源

| 集群名称                                                     | 作用                    | 资产简介         | 说明         |
| ------------------------------------------------------------ | ----------------------- | ---------------- | ------------ |
| [cetest](https://git.youle.game/TC/TSD/DevOps/documents/wikis/game-supporting/tkw/details/tkw-ce-test-env) | CE-TEST                 | 1 x ECS 4core8G  | 375.750元/月 |
| [sapprft]()                                                  | 版署审核                | 1 x ECS 8core16G | 654.000元/月 |
| [testing](https://ecs.console.aliyun.com/?spm=5176.2020520152.favorites.decs.261716ddWEIIwm#/server/i-bp1h073jqg8vmpvdbwhu/detail?regionId=cn-hangzhou) | 外网 test 集群          | 1 x ECS 8core16G | 312.00元/月  |
| AliTKWTestA                                                  | 外网，压测集群          | 9 x ECS 8core16G | 5886 元/月   |
| AliTKWTestB                                                  | 云游戏用包              | 1 x ECS 8core16G | 312.00元/月  |
| AliTKWTestC                                                  | 外网，battle 模块测试   | 1 x ECS 8core16G | 312.00元/月  |
| AliTKWTestD                                                  | 外网，周版本验证        | 1 x ECS 8core16G | 312.00元/月  |
| T-Cloud-MildTest                                             | 腾讯云轻测环境          | 7 x CVM 4core8G  | 由腾讯提供   |
| T-Cloud-TY                                                   | 腾讯云体验集群          | 1 x CVM 4core8G  | 由腾讯提供   |
| T-Cloud-Debug                                             | 腾讯云IDC接入环境调试用 | 6 x CVM 4core8G  | 由腾讯提供   |
| T-Cloud-MidasTest                                            | 腾讯云IDC接入 | 1 x CVM 4core8G  | 由腾讯提供   |
| T-IDC-Daily                                            | 腾讯云IDC测试集群 | 15 x CVM 4core8G  | 由腾讯提供   |
