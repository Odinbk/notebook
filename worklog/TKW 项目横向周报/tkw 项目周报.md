



重要工作和节点
---

- 版本支持（环境部署、版本构建、业务监控）
- 腾讯 IDC 环境接入
- 11月第二周做一次公司测试（完成）
- 我们 12 月初做一次对外测试，人数大概5000左右（暂定）



### 本周总结

- 调整 tkw mtool ci 到 jenkins 
- 细查单服务器集群下 battle 进程自动挂掉的原因

- - unpack 步骤导致，已修改 tools 调用 tar 命令解压，同步修 monit

- IDC 环境接入

- - 和腾讯武曦沟通开服时间的维护细节：cc 上配置，更新配置文件，gse 执行操作
  - 推进天梯流程和区服维护和踢玩家下线的的实现和测试：天梯流程均正常工作

- IDC 仿真环境使用 [配置文件](https://topjoy.yuque.com/tsd/services/urxg3n)，接入 pillar 测试结果

|                                                 | 天梯运行结果 |
| ----------------------------------------------- | ------------ |
| 9001-版本管理-正式发版-启动所有服务             | 成功         |
| 9002-版本管理-正式发布-切维护-restart所有服务   | 成功         |
| 9003-版本管理-正式发版-不切维护-restart所有服务 | 成功         |
| 9004-版本管理-正式发版-不切维护-reload所有服务  | 成功         |
| 9007-版本管理-Hotfix全服更新                    | 成功         |
| 9008-版本管理-Hotfix数值表                      | 成功         |
| 9009-版本管理-Hotfix meta                       | 成功         |
| 9101-区服管理-设置全区维护                      | 成功         |
| 9102-区服管理-解除全区维护                      | 成功         |
| 9013-区服管理-设置区服维护                      | 成功         |
| 9104-区服管理-解除区服维护                      | 成功         |
| 9105-区服管理-刷新区服信息                      | 成功         |
| 9106-区服管理-修改区服开服时间                  | 成功         |
| 9107-区服管理-踢全服玩家下线                    | 成功         |
| 9108-区服管理-踢区服玩家下线                    | 成功         |
| 9109-区服管理-审核服修改区服开服时间            | 暂时没用到   |
| 9201-进程管理-启动所有服务                      | 成功         |
| 9202-进程管理-停止所有服务                      | 成功         |
| 9203-进程管理-重启所有服务                      | 成功         |
| 9204-进程管理-重载所有服务                      | 成功         |
| 9205-进程管理-强制停止所有服务                  | 成功         |



### 下周计划

- 细化并推进 tkw 入驻深圳的工作（见 tower https://tower.im/projects/b6a7d4ccb065ae003db35036d1faaa58/list/todos/）



### 工具接入

接入状态

| 系统名称      | 优先级 | 状态 | ETA  | 说明                   |
| ------------- | ------ | ---- | ---- | ---------------------- |
| 天梯          | `高`   | 完成 |      | 灰度，审核相关暂未展开 |
| 前后端报错    | `高`   | 完成 |      | 已接入，持续迭代       |
| BI            | `高`   | 完成 |      | 已接入，持续迭代       |
| GM            | `高`   | 完成 |      | 已接入，持续迭代       |
| 鹰眼          | `高`   | 完成 |      | 已接入，持续迭代       |
| 监控/报警系统 | `高`   | 完成 |      |                        |



### 集群资源

| 集群名称                                                     | 作用                    | 资产简介         | 说明         |
| ------------------------------------------------------------ | ----------------------- | ---------------- | ------------ |
| [cetest](https://git.youle.game/TC/TSD/DevOps/documents/wikis/game-supporting/tkw/details/tkw-ce-test-env) | CE-TEST                 | 1 x ECS 4core8G  | 375.750元/月 |
| [sapprft]()                                                  | 版署审核                | 1 x ECS 8core16G | 654.000元/月 |
| [testing](https://ecs.console.aliyun.com/?spm=5176.2020520152.favorites.decs.261716ddWEIIwm#/server/i-bp1h073jqg8vmpvdbwhu/detail?regionId=cn-hangzhou) | 外网 test 集群          | 1 x ECS 8core16G | 312.00元/月  |
| AliTKWTestA                                                  | 外网，压测集群          | 9 x ECS 8core16G | 5886 元/月   |
| AliTKWTestB                                                  | 云游戏用包              | 1 x ECS 8core16G | 312.00元/月  |
| AliTKWTestC                                                  | 外网，battle 模块测试   | 1 x ECS 8core16G | 312.00元/月  |
| AliTKWTestD                                                  | 外网，周版本验证        | 1 x ECS 8core16G | 312.00元/月  |
| T-Cloud-MildTest                                             | 腾讯云轻测环境          | 7 x CVM 4core8G  | 由腾讯提供   |
| T-Cloud-TY                                                   | 腾讯云体验集群          | 1 x CVM 4core8G  | 由腾讯提供   |
| T-Cloud-IDCTestA                                             | 腾讯云IDC接入环境调试用 | 6 x CVM 4core8G  | 由腾讯提供   |