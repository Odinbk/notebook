# TKW 项目周报 - 2020-12-19

## 重要时间节点

- 12月10日对外测试，人数5000， 18日结束测试。

## 本周总结

* Review了TKW的打包脚本，脚本结构和代码被修改的杂乱无章，在逐步重构中。
* 和腾讯联调TSS流程，基本流程调试通过，联调过程中得知腾讯提供的redis服务不支持pub/sub功能，业务使用该功能的代码需要调整。
* 搭建腾讯云环境中，用于联调米大师的集群环境： T-Cloud-MidasTest, 规格以及成本参考`集群资源`表。
* 调研TKW深圳驻场git仓库对gitlab runner的需求，确定部署方式。
* 测试git lfs仓库的导出，还原过程能保证仓库的完整性，为深圳驻场仓库迁移做准备。
* 和项目组确认深圳驻场，ResourceCenter需要迁移的文件目录列表。
* 和项目组后端讨论深圳驻场开发环境如何搭建，目前有两套方案：
  * 开发环境迁移到阿里云。好处是开发环境不受物理位置的限制，只要有网络就可以工作。缺点是没有网络的情况下工作无法开展。
  * 购买采购开发机主机。好处是没有网络的离线状态下不影响工作。缺点是一次性成本高，受物理位置影响，办公环境迁移不友好。
  * 迁移到阿里云的方案需要解决阿里云主机上如何拉取内网代码仓库。运维在调研内网和阿里云网络环境打通的方案，进展会保持更新。

## 下周工作

* 推进腾讯TSS中流程的创建，腾讯方准备好后完整测试天梯流程。
* 调研内网和阿里云网络环境打通的方案，进展会保持更新。

## 工具接入

### 已完成的系统对接

| 系统名称      | 优先级 | 状态 | ETA  | 说明                   |
| ------------- | ------ | ---- | ---- | ---------------------- |
| 天梯          | `高`   | 完成 |      | 灰度，审核相关暂未展开 |
| 前后端报错    | `高`   | 完成 |      | 已接入，持续迭代       |
| BI            | `高`   | 完成 |      | 已接入，持续迭代       |
| GM            | `高`   | 完成 |      | 已接入，持续迭代       |
| 鹰眼          | `高`   | 完成 |      | 已接入，持续迭代       |
| 监控/报警系统 | `高`   | 完成 |      |                        |

## 集群资源

| 集群名称                                                     | 作用                    | 资产简介         | 说明         |
| ------------------------------------------------------------ | ----------------------- | ---------------- | ------------ |
| [cetest](https://git.youle.game/TC/TSD/DevOps/documents/wikis/game-supporting/tkw/details/tkw-ce-test-env) | CE-TEST                 | 1 x ECS 4core8G  | 375.750元/月 |
| [sapprft]()                                                  | 版署审核                | 1 x ECS 8core16G | 654.000元/月 |
| [testing](https://ecs.console.aliyun.com/?spm=5176.2020520152.favorites.decs.261716ddWEIIwm#/server/i-bp1h073jqg8vmpvdbwhu/detail?regionId=cn-hangzhou) | 外网 test 集群          | 1 x ECS 8core16G | 312.00元/月  |
| AliTKWTestA                                                  | 外网，压测集群          | 9 x ECS 8core16G | 5886 元/月   |
| AliTKWTestB                                                  | 云游戏用包              | 1 x ECS 8core16G | 312.00元/月  |
| AliTKWTestC                                                  | 外网，battle 模块测试   | 1 x ECS 8core16G | 312.00元/月  |
| AliTKWTestD                                                  | 外网，周版本验证        | 1 x ECS 8core16G | 312.00元/月  |
| T-Cloud-MildTest                                             | 腾讯云轻测环境          | 7 x CVM 4core8G  | 由腾讯提供   |
| T-Cloud-TY                                                   | 腾讯云体验集群          | 1 x CVM 4core8G  | 由腾讯提供   |
| T-Cloud-IDCTestA                                             | 腾讯云IDC接入环境调试用 | 6 x CVM 4core8G  | 由腾讯提供   |
| T-Cloud-MidasTest                                            | 腾讯云IDC接入 | 1 x CVM 4core8G  | 由腾讯提供   |
