# DevOps项目组周报

## 本周工作

### Vega

* 调整RabbitMQ的策略，队列由单队列修改为一主一备
    * 调整策略后有40%左右的性能损耗
    * online的RabbitMQ集群由13节点扩容到19节点
* 下线online的35台world server作为备机
* 客户端分享图等资源迁移到正式CDN
* 腾讯职能化接入及运维模板整理
* 雪球及开服测试
* 单独拆分prometheus服务器用于online的数据提取
* 单功能压力测试及yace全流程环境部署与测试

### TKW

* 推进 tkw 入驻深圳办公室工作内容的讨论，落实到 tower 上的任务。
* 细查单服务器集群 battle 服务自动挂掉的原因，用tar软件替代python tarfile做解压缩操作来暂时解决问题。
* 处理 tkw 上天梯流程清理 zk 数据，调整参数。

### GBF

* GBF添加新的测试集群 -- 进行中
* 天梯流程中添加踢玩家下线，服务器维护，全区维护，设置开服时间等流程。
* 跟进Jenkins监控反映的CI流程触发数据偏低的情况。

### YK

* 处理线上服务器故障。
  * 故障描述： 2020年11月20日18:00 收到 8.209.243.254 服务器宕机告警， 2020年11月20日18:04 恢复，宕机4分钟。服务器上运行的notice服务通过负载均衡器提供高可靠能力，未对线上玩家产生影响。
  * 故障后处理：服务器启动后，服务器上运行的notice服务自动拉起，logbus服务手动启动
  * 故障原因： 和阿里云客服确认是服务器所在的宿主机故障，触发宕机迁移

### DK

* DK例行版本发布，Notice，VMS，Global三合一服务器配置升级，解决内存告警的问题。

### 加帕里公园

* 创建对外测试集群。

### DevOps

* Pillar添加功能：设置开服时间，服务器维护，全区维护，踢玩家下线等功能接口。
* Craft Inventory适配蓝鲸CMDB。
* 整理SVN权限分配的需求，Demo，为后续开发做准备。
* 组内推进蓝鲸ITSM运维流程管理工具，规范运维操作流程。
* Vega深圳办公环境迁移回北京：RC数据同步，Jenkins任务同步。
* 梳理LDAP使用情况，设计LDAP分组结构，整理文档。
* Thomas, Workflow, WallE迁移到公司私有化部署的Sentry服务上。
* 完善Grafana + Jenkins InfluxDB Plugin实现的Jenkins任务数据收集，可视化展示，告警Dashboard。
