# DevOps项目组组周报

## WallE

### DK

支持马甲包发布，多个审核服的需求。

* 多审核服方案代码修改完成，包括dk, vege, tkw, payment相关的pipeline打包脚本，tools运维脚本，eve和WallE的调整。
* DK后端模块GameServer, BattleServer, Global, VMS, Notice相关修改完成 (@张旭军)
* DK联调测试通过，可以同时发布多个审核服版本，分别单独切上线。包括从WallE打包到天梯发布完整流程。
* Vega打包脚本针对WallE的调整做了适配，不影响正常发包，有多审核需求时游戏后端模块做适配调整即可支持。
* TKW打包脚本针对WallE调整做了适配，不影响正常发包，已可以支持多审核需求。

发布计划：

* DK目前线上有一个iOS版本在审核，所以多审核的方案上线推迟到DK的在审版本过审后上线。预计下周三上线。
* 本次上线DK会有三个审核服部署位置上线: HWReplicaA, HWReplicaB, HWReplicaC。集群已就位，资产已录入CMDB。

### Vega

* 重签名工具支持更换App Name，App Icon. 已发布上线 (@张军).
* iOS包可更换App Name，App Icon；Android包只能更换App Icon.

### TKW

* Tools运维脚本接入CI, 工具包上传aliyun oss.
* 天梯流程，Tools运维脚本适配TKW取消Global全区维护的改动。

### YK

* TWK的热更新方案完成，YK可以开始接入。DevOps负责跟进。
* 可以逐步开始使用WallE来打包。

### GGG

* 本周无进展

## 本周工作

* 在真实部署位置上测试DK马甲包需要支持多个审核服的需求。
* WallE, Workflow日志收集接入[Kibana](http://kibana.youle.cloud/app/kibana#/discover?_g=()&_a=(columns:!(_source),index:'2bc5bea0-f3e9-11e9-aa19-951315f9e357',interval:auto,query:(language:lucene,query:''),sort:!('@timestamp',desc)))
* 迁移ECS上的数据库到aliyun RDS，回收数据库ECS。
* Tools运维脚本逐步开始接入CI。

## 下周计划

* WallE支持不更新版本重复打包；编辑历史版本，等需求设计开发。

### 相关文档

* [弹性发布方案](https://git.youle.game/TC/TSD/DevOps/dune/wikis/elastic_release)
* [服务器端灰度/审核服方案](https://git.youle.game/TC/TSD/DevOps/dune/wikis/%E5%90%8E%E7%AB%AF%E6%96%87%E6%A1%A3/appstore_review_and_gray)
* [客户端灰度发布方案](https://git.youle.game/TC/TSD/DevOps/dune/wikis/%E5%89%8D%E7%AB%AF%E6%96%87%E6%A1%A3/gray-server)
* [客户端审核服方案](https://git.youle.game/TC/TSD/DevOps/dune/wikis/%E5%89%8D%E7%AB%AF%E6%96%87%E6%A1%A3/apple-review-version)
* [Jenkins任务组织](https://git.youle.game/TC/TSD/DevOps/dune/wikis/jenkins_authorization)
* [CI/CD系统接入Step By Step文档](https://git.youle.game/TC/TSD/DevOps/dune/wikis/integrate_walle_step_by_step)
* [GameStatic/Patch](https://git.youle.game/TC/TSD/DevOps/dune/wikis/Release-Note-v0.1.2)