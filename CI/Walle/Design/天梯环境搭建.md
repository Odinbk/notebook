# 环境搭建

环境使用docker-compose搭建

## 前置准备

运行天梯的服务器上提前准备：

* docker
* docker-compose
* harbor镜像管理仓库
* Nexus组件管理仓库
* MySql(5.7)，从dump文件中恢复相关数据。

提前搭建好nexus repository组件管理服务，缓存镜像制作过程中使用到的第三方组件。

## 容器环境

### Dockerfile

跳转到Dockerfile目录，执行`docker build -t workflow ./`验证Dockerfile正确。
MongoDB也使用容器启动，作为docker-compose的一部分。

### 启动服务

* 首次启动服务先执行`docker-compose up`
* 启动服务`docker-compose start`
* 停止服务`docker-compose down`
* 重启服务`docker-compose restart`
* 单独重启WallE`docker-compose up walle`
* 升级数据库`docker-compose exec walle flask db init`
